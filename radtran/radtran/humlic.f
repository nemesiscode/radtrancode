      REAL FUNCTION HUMLIC(X,Y)
C     $Id: humlic.f,v 1.2 2011-06-17 15:40:26 irwin Exp $
C     COMPUTES THE COMPLEX PROBABILITY FUNCTION W(Z)=EXP(-Z*Z)*ERFC(-Z*Z)
C     IN THE UPPER HALF PLANE Z=X+IY (I.E. FOR Y>=0)
C     MAXIMUM RELATIVE ERROR OF BOTH REAL AND IMAGINARY PARTS IS <1*10**(-4)
C     CODE FROM HUMLICEK JQSRT 27 (1982) PAGE 437
C
C     THEN RETURNS THE SCALED REAL PART WHICH IS THE VOIGT FUNCTION
      COMPLEX T,U
      REAL SQRTPI
      PARAMETER (SQRTPI=0.5641896)
C
      T=CMPLX(Y,-X)
      S=ABS(X)+Y
      IF(S.LT.15) GOTO 1
C **  REGION I
      HUMLIC1=T*0.5641896/(0.5+T*T)
      HUMLIC = REAL(HUMLIC1*SQRTPI)
      RETURN
    1 IF(S.LT.5.5) GOTO 2
C **  REGION II
      U=T*T
      HUMLIC1=T*(1.410474 + U*.5641896)/(.75 + U*(3.+U))
      HUMLIC = REAL(HUMLIC1*SQRTPI)
      RETURN
    2 IF(Y .LT. .195*ABS(X)-.176) GO TO 3
C **  REGION III
      HUMLIC1=
     / (16.4955+T*(20.20933+T*(11.96482+T*(3.778987+T*.5642236))))/
     / (16.4955+T*(38.82363+T*(39.27121+T*(21.69274+T*(6.699398+T)))))
      HUMLIC = REAL(HUMLIC1*SQRTPI)
      RETURN
C **  REGION IV
    3 U=T*T
      HUM1=CEXP(U)-T*(36183.31-U*(3321.9905-U*(1540.787-U*(219.0313-U*
     /  (35.76683-U*(1.320522-U*.56419))))))/(32066.6-U*(24322.84-U*
     /(9022.228-U*(2186.181-U*(364.2191-U*(61.57037-U*(1.841439-U)))))))
      HUMLIC = REAL(HUM1*SQRTPI)
      RETURN
      END
