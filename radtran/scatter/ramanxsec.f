      SUBROUTINE RAMANXSEC(LAMBDA,SPECS0,SPECS1,SPECQ)
C     ***********************************************************************
C     Subroutine to calculate RAMAN x-sections after Sromovsky 2005. 
C     Routine uses x-section tables calculated using coefficents of 
C     Ford and Brown (1973)
C
C     Input variable:
C	LAMBDA	REAL	Wavelength (microns)
C
C     Output variables
C	SPECS0	REAL	S0 x-section (cm2)
C	SPECS1	REAL	S1 x-section (cm2)
C	SPECQ	REAL	Combined x-section (cm2)
C
C     Pat Irwin	7/6/21
C
C     ***********************************************************************

      IMPLICIT NONE
      REAL LAMBDA,LAMBDA0,DLAMBDA,LAMBDA1
      REAL FRAC
      DOUBLE PRECISION SPECS0,SPECS1,SPECQ
      INTEGER ILAMBDA,I
      PARAMETER (LAMBDA0=0.15,DLAMBDA=0.01)
      INCLUDE '../includes/arrdef.f'


C     Raman x-sections (cm2) computed from coefficents of Ford and Brown (1973).
C     x-sections calculated with construct_raman_xsec.pro in 
C     ~/MacProDocs/Papers/Neptune_Uranus_All/idl/Rayleigh_scattering.
C     Cross-sections are listed as natural log values.

      REAL FSPECS0(96),FSPECS1(96),FSPECQ(96),WAVE(96)

      DATA (WAVE(I),I=1,96)/0.150000,0.160000,0.170000,0.180000,
     & 0.190000,0.200000,
     & 0.210000,0.220000,0.230000,0.240000,0.250000,0.260000,0.270000,
     & 0.280000,0.290000,0.300000,0.310000,0.320000,0.330000,0.340000,
     & 0.350000,0.360000,0.370000,0.380000,0.390000,0.400000,0.410000,
     & 0.420000,0.430000,0.440000,0.450000,0.460000,0.470000,0.480000,
     & 0.490000,0.500000,0.510000,0.520000,0.530000,0.540000,0.550000,
     & 0.560000,0.570000,0.580000,0.590000,0.600000,0.610000,0.620000,
     & 0.630000,0.640000,0.650000,0.660000,0.670000,0.680000,0.690000,
     & 0.700000,0.710000,0.720000,0.730000,0.740000,0.750000,0.760000,
     & 0.770000,0.780000,0.790000,0.800000,0.810000,0.820000,0.830000,
     & 0.840000,0.850000,0.860000,0.870000,0.880000,0.890000,0.900000,
     & 0.910000,0.920000,0.930000,0.940000,0.950000,0.960000,0.970000,
     & 0.980000,0.990000,1.000000,1.010000,1.020000,1.030000,1.040000,
     & 1.050000,1.060000,1.070000,1.080000,1.090000,1.100000/


      DATA (FSPECS0(I),I=1,96) /-59.2398,-59.6811,-60.0735,
     & -60.4258,-60.7449,
     & -61.0364,-61.3046,-61.5531,-61.7846,-62.0015,-62.2055,-62.3983,
     & -62.5810,-62.7547,-62.9204,-63.0788,-63.2305,-63.3762,-63.5163,
     & -63.6513,-63.7816,-63.9075,-64.0294,-64.1474,-64.2618,-64.3729,
     & -64.4809,-64.5859,-64.6882,-64.7878,-64.8849,-64.9797,-65.0722,
     & -65.1626,-65.2509,-65.3373,-65.4219,-65.5047,-65.5858,-65.6653,
     & -65.7432,-65.8197,-65.8947,-65.9683,-66.0406,-66.1117,-66.1815,
     & -66.2501,-66.3176,-66.3840,-66.4493,-66.5136,-66.5768,-66.6392,
     & -66.7005,-66.7610,-66.8206,-66.8794,-66.9373,-66.9944,-67.0507,
     & -67.1063,-67.1611,-67.2153,-67.2687,-67.3214,-67.3735,-67.4250,
     & -67.4758,-67.5260,-67.5756,-67.6246,-67.6731,-67.7210,-67.7684,
     & -67.8152,-67.8615,-67.9073,-67.9527,-67.9975,-68.0419,-68.0858,
     & -68.1292,-68.1723,-68.2148,-68.2570,-68.2988,-68.3401,-68.3810,
     & -68.4216,-68.4618,-68.5016,-68.5410,-68.5801,-68.6188,-68.6572/

      DATA (FSPECS1(I),I=1,96) /-59.7622,-60.2041,-60.5971,
     & -60.9500,-61.2697,
     & -61.5619,-61.8308,-62.0800,-62.3123,-62.5300,-62.7348,-62.9284,
     & -63.1119,-63.2865,-63.4530,-63.6122,-63.7649,-63.9114,-64.0524,
     & -64.1883,-64.3195,-64.4463,-64.5690,-64.6880,-64.8033,-64.9154,
     & -65.0243,-65.1302,-65.2334,-65.3339,-65.4320,-65.5277,-65.6212,
     & -65.7125,-65.8018,-65.8892,-65.9747,-66.0584,-66.1405,-66.2209,
     & -66.2998,-66.3772,-66.4532,-66.5278,-66.6011,-66.6731,-66.7439,
     & -66.8134,-66.8819,-66.9492,-67.0155,-67.0808,-67.1451,-67.2083,
     & -67.2707,-67.3322,-67.3927,-67.4525,-67.5114,-67.5695,-67.6268,
     & -67.6834,-67.7392,-67.7943,-67.8487,-67.9025,-67.9556,-68.0080,
     & -68.0598,-68.1110,-68.1616,-68.2117,-68.2611,-68.3100,-68.3584,
     & -68.4062,-68.4536,-68.5004,-68.5467,-68.5926,-68.6380,-68.6829,
     & -68.7274,-68.7714,-68.8150,-68.8582,-68.9009,-68.9433,-68.9853,
     & -69.0269,-69.0681,-69.1089,-69.1493,-69.1894,-69.2292,-69.2686/

      DATA (FSPECQ(I),I=1,96) /-59.5807,-60.0681,-60.5024,
     & -60.8928,-61.2468,
     & -61.5704,-61.8686,-62.1451,-62.4032,-62.6453,-62.8736,-63.0898,
     & -63.2953,-63.4912,-63.6787,-63.8584,-64.0312,-64.1977,-64.3585,
     & -64.5139,-64.6645,-64.8106,-64.9526,-65.0907,-65.2252,-65.3563,
     & -65.4843,-65.6094,-65.7317,-65.8513,-65.9686,-66.0835,-66.1962,
     & -66.3068,-66.4155,-66.5223,-66.6273,-66.7307,-66.8324,-66.9326,
     & -67.0313,-67.1287,-67.2247,-67.3194,-67.4129,-67.5052,-67.5964,
     & -67.6866,-67.7757,-67.8638,-67.9510,-68.0373,-68.1227,-68.2072,
     & -68.2910,-68.3739,-68.4562,-68.5377,-68.6185,-68.6987,-68.7782,
     & -68.8571,-68.9354,-69.0131,-69.0903,-69.1670,-69.2432,-69.3189,
     & -69.3941,-69.4688,-69.5432,-69.6171,-69.6906,-69.7638,-69.8365,
     & -69.9090,-69.9810,-70.0528,-70.1243,-70.1954,-70.2663,-70.3369,
     & -70.4072,-70.4774,-70.5472,-70.6169,-70.6863,-70.7556,-70.8247,
     & -70.8936,-70.9623,-71.0309,-71.0993,-71.1677,-71.2359,-71.3039/


      IF(LAMBDA.LT.LAMBDA0.OR.LAMBDA.GT.WAVE(96))THEN
       SPECS0 = 0.0
       SPECS1 = 0.0
       SPECQ  = 0.0
       RETURN
      ENDIF

      ILAMBDA=1+INT((LAMBDA-LAMBDA0)/DLAMBDA)
      IF(ILAMBDA.GE.96)THEN
       ILAMBDA=95
      ENDIF
      LAMBDA1 = LAMBDA0+(ILAMBDA-1)*DLAMBDA

      FRAC=(LAMBDA-LAMBDA1)/DLAMBDA
      SPECS0 = (1.0-FRAC)*FSPECS0(ILAMBDA) + FRAC*FSPECS0(ILAMBDA+1)
      SPECS1 = (1.0-FRAC)*FSPECS1(ILAMBDA) + FRAC*FSPECS1(ILAMBDA+1)
      SPECQ = (1.0-FRAC)*FSPECQ(ILAMBDA) + FRAC*FSPECQ(ILAMBDA+1)

      SPECS0 = DEXP(SPECS0)
      SPECS1 = DEXP(SPECS1)
      SPECQ  = DEXP(SPECQ)

      RETURN

      END
